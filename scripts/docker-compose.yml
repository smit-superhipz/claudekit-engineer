services:
  claudekit-server:
    image: nginx:alpine
    container_name: claudekit-releases
    ports:
      - "4567:80"
    volumes:
      - ./:/usr/share/nginx/html:ro
    restart: unless-stopped

  trigger:
    image: python:3.11-alpine
    container_name: claudekit-trigger
    ports:
      - "4568:8080"
    volumes:
      - ./:/app
    working_dir: /app
    command: sh -c "apk add --no-cache bash curl && python trigger-server.py"
    environment:
      - GITHUB_TOKEN=${GITHUB_TOKEN}
    restart: unless-stopped
